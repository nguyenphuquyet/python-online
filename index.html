<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>NGUYENPHUQUYET - PYTHON ONLINE</title>

<meta name="description" content="Ch·∫°y code python online kh√¥ng c·∫ßn c√†i app">
<meta property="og:title" content="NGUYENPHUQUYET - PYTHON ONLINE">
<meta property="og:description" content="Ch·∫°y code python online kh√¥ng c·∫ßn c√†i app">
<meta property="og:image" content="https://i.ibb.co/mCY28Dxr/Zp-Bxd-R5-Le-NNTx-Et-H-ZDIw-ODc5-ZDQt-Nm-Nl-NC00-Nj-Vm-LTg0-Zm-Qt-ZDBj-N2-Iz-YTEx-OTVl-oxylabs-images-05.webp">

<link rel="icon" href="https://images.icon-icons.com/1508/PNG/512/python_104451.png">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>

<style>
html, body { height: 100%; }
textarea { overflow: hidden; }
.theme-active {
  outline: 2px solid #22c55e;
  outline-offset: 2px;
}
#overlay.hidden { pointer-events: none; }
</style>
</head>

<body class="h-[100dvh] overflow-hidden bg-black text-green-400">

<div class="flex flex-col h-full">

<!-- HEADER -->
<div id="header"
 class="flex items-center justify-between px-4 py-2 border-b text-sm font-mono">
  <div>Python 3.11 ‚Äî Browser REPL</div>
  <button id="settingsBtn">‚öôÔ∏è C√†i ƒë·∫∑t</button>
</div>

<!-- TERMINAL -->
<div id="terminal"
 class="flex-1 overflow-y-auto px-4 py-3 font-mono space-y-1"></div>

<!-- INPUT -->
<div id="inputBar" class="border-t px-4 py-3">
  <div class="flex items-end gap-2">
    <span id="prompt" class="select-none">>>> </span>
    <textarea id="input" rows="1"
      class="flex-1 bg-transparent resize-none outline-none font-mono"
      placeholder="Nh·∫≠p Python..."></textarea>
    <button id="runBtn"
      class="h-[1.5rem] px-3 rounded font-semibold">‚ñ∂</button>
  </div>
</div>

</div>

<!-- OVERLAY -->
<div id="overlay" class="fixed inset-0 z-40 hidden"></div>

<!-- SIDEBAR -->
<aside id="sidebar"
 class="fixed top-0 right-0 h-full w-72 translate-x-full transition-transform z-50 flex flex-col">

  <div id="sidebarHeader"
   class="flex items-center justify-between px-4 py-3 border-b text-sm">
    <div>‚öôÔ∏è C√†i ƒë·∫∑t</div>
    <button id="closeSidebar">‚úï</button>
  </div>

  <div id="sidebarBody" class="p-4 space-y-4 text-sm">
    <div>
      <div class="mb-2 font-medium">Theme</div>
      <div class="grid grid-cols-2 gap-2">
        <button data-theme="hacker" class="themeBtn px-3 py-2 rounded">Hacker</button>
        <button data-theme="dark" class="themeBtn px-3 py-2 rounded">Dark</button>
        <button data-theme="light" class="themeBtn px-3 py-2 rounded">Light</button>
        <button data-theme="midnight" class="themeBtn px-3 py-2 rounded">Midnight</button>
      </div>
    </div>

    <div id="credit" class="text-xs border-t pt-3">
      Ph√°t tri·ªÉn b·ªüi Nguy·ªÖn Ph√∫ Quy·∫øt
    </div>
  </div>
</aside>

<!-- IN APP WARNING -->
<div id="inAppWarning"
 class="fixed inset-0 z-[999] hidden bg-black/80 flex items-center justify-center px-4">
  <div class="bg-black border border-red-500 rounded-lg p-4 max-w-sm w-full text-center">
    <div class="text-red-400 font-bold mb-2">‚ö†Ô∏è Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£</div>
    <div class="text-sm mb-4 text-gray-300">
      Trang kh√¥ng h·ªó tr·ª£ tr√¨nh duy·ªát t√≠ch h·ª£p (Messenger / Facebook / Zalo)
    </div>
    <button id="openExternal"
     class="w-full bg-green-600 text-black font-semibold py-2 rounded">
      üåê M·ªü b·∫±ng tr√¨nh duy·ªát ngo√†i
    </button>
  </div>
</div>

<script>
/* ================= ELEMENTS ================= */
const terminal = document.getElementById("terminal");
const input = document.getElementById("input");
const runBtn = document.getElementById("runBtn");
const inputBar = document.getElementById("inputBar");
const promptEl = document.getElementById("prompt");
const header = document.getElementById("header");

const settingsBtn = document.getElementById("settingsBtn");
const sidebar = document.getElementById("sidebar");
const sidebarHeader = document.getElementById("sidebarHeader");
const overlay = document.getElementById("overlay");
const closeSidebar = document.getElementById("closeSidebar");
const credit = document.getElementById("credit");
const themeButtons = document.querySelectorAll(".themeBtn");

/* ================= PYODIDE ================= */
let pyodide;
async function start() {
  terminal.textContent = "ƒêang t·∫£i Python...";
  pyodide = await loadPyodide();
  pyodide.setStdout({ batched: s => s.trim() && printLine(s) });
  pyodide.setStderr({ batched: s => s.trim() && printLine(s, "error") });
  terminal.textContent = "";
  printLine("Python 3.11 (Pyodide)");
}
start();

function printLine(text, type="output") {
  const div = document.createElement("div");
  div.className = type === "error" ? "text-red-500" : "";
  div.textContent = text;
  terminal.appendChild(div);
  terminal.scrollTop = terminal.scrollHeight;
}

/* ================= RUN ================= */
runBtn.onclick = async () => {
  if (!input.value.trim()) return;
  printLine(">>> " + input.value);
  try {
    const r = await pyodide.runPythonAsync(input.value);
    if (r !== undefined) printLine(String(r));
  } catch(e) {
    printLine(e.toString(), "error");
  }
  input.value = "";
};

/* ================= AUTO RESIZE + KEYBOARD FIX ================= */
input.addEventListener("input", () => {
  input.style.height = "1.5rem";
  input.style.height = input.scrollHeight + "px";
});
input.addEventListener("focus", () => {
  setTimeout(() => {
    inputBar.scrollIntoView({ behavior: "smooth", block: "end" });
  }, 300);
});

/* ================= SIDEBAR ================= */
settingsBtn.onclick = () => {
  sidebar.classList.remove("translate-x-full");
  overlay.classList.remove("hidden");
};
closeSidebar.onclick = overlay.onclick = () => {
  sidebar.classList.add("translate-x-full");
  overlay.classList.add("hidden");
};

/* ================= THEMES (FIXED) ================= */
const themes = {
  hacker: {
    body: "bg-black text-green-400",
    border: "border-green-700",
    prompt: "text-green-400",
    input: "text-green-400 placeholder-green-600",
    button: "bg-green-600 text-black hover:bg-green-500",
    sidebar: "bg-black text-green-400",
    overlay: "bg-black/50"
  },
  dark: {
    body: "bg-black text-gray-100",
    border: "border-gray-800",
    prompt: "text-blue-400",
    input: "text-gray-100 placeholder-gray-500",
    button: "bg-blue-600 text-white",
    sidebar: "bg-black text-gray-100",
    overlay: "bg-black/60"
  },
  light: {
    body: "bg-gray-100 text-gray-900",
    border: "border-gray-300",
    prompt: "text-blue-600",
    input: "text-gray-900 placeholder-gray-400",
    button: "bg-blue-600 text-white",
    sidebar: "bg-white text-gray-900",
    overlay: "bg-black/30"
  },
  midnight: {
    body: "bg-slate-950 text-slate-100",
    border: "border-slate-800",
    prompt: "text-cyan-400",
    input: "text-slate-100 placeholder-slate-500",
    button: "bg-cyan-600 text-black",
    sidebar: "bg-slate-950 text-slate-100",
    overlay: "bg-black/70"
  }
};

function applyTheme(name) {
  const t = themes[name];
  if (!t) return;

  document.body.className = `h-[100dvh] overflow-hidden ${t.body}`;
  header.className = `flex items-center justify-between px-4 py-2 border-b text-sm font-mono ${t.border}`;
  inputBar.className = `border-t px-4 py-3 ${t.border}`;
  promptEl.className = `${t.prompt} select-none`;
  input.className = `flex-1 bg-transparent resize-none outline-none font-mono ${t.input}`;
  runBtn.className = `h-[1.5rem] px-3 rounded font-semibold ${t.button}`;
  sidebar.className = `fixed top-0 right-0 h-full w-72 translate-x-full transition-transform z-50 flex flex-col ${t.sidebar}`;
  sidebarHeader.className = `flex items-center justify-between px-4 py-3 border-b text-sm ${t.border}`;
  credit.className = `text-xs border-t pt-3 ${t.border}`;
  overlay.className = `fixed inset-0 z-40 hidden ${t.overlay}`;

  themeButtons.forEach(btn =>
    btn.classList.toggle("theme-active", btn.dataset.theme === name)
  );

  localStorage.setItem("theme", name);
}

themeButtons.forEach(btn =>
  btn.onclick = () => applyTheme(btn.dataset.theme)
);

applyTheme(localStorage.getItem("theme") || "hacker");

/* ================= IN-APP BROWSER ================= */
function isInAppBrowser() {
  return /FBAN|FBAV|Messenger|Instagram|Zalo|Line|TikTok/i.test(navigator.userAgent);
}

if (isInAppBrowser()) {
  document.getElementById("inAppWarning").classList.remove("hidden");
  document.getElementById("openExternal").onclick = () => {
    const url = location.href.replace(/^https?:\/\//, "");
    if (/Android/i.test(navigator.userAgent)) {
      location.href =
        "intent://" + url + "#Intent;scheme=https;package=com.android.chrome;end";
    } else {
      alert("Nh·∫•n ‚ãØ ‚Üí M·ªü b·∫±ng Safari");
    }
  };
}
</script>

</body>
</html>